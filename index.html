<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Survey Options with Particles</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Electrolize&family=Funnel+Display:wght@300..800&display=swap" rel="stylesheet">
    <style>
        html, body {
            margin: 0;
            height: 100%;
            overflow: hidden;
            background-color: #111;
            font-family: "Funnel Display", sans-serif;
        }

        /* Particle canvas behind everything */
        #particleCanvas {
            position: fixed;
            inset: 0;
            z-index: 0;
        }

        .frosted-glass{
            position: relative;
            z-index: 1; /* ABOVE particles */
            height: 600px;
            width: 800px;
            background: radial-gradient(farthest-corner at 37% 0%, #d73f09ff 0%, #d7400952 40%, #ffffff00 58%), 
                        radial-gradient(farthest-corner at 53% 0%, #f7a162ff 0%, #f8a16399 10%, #ffffff00 48%), 
                        linear-gradient(to top, #ffffff10 100%, #ffffff10 100%);
            box-shadow: 0 4px 30px rgb(0, 0, 0);
            backdrop-filter: blur(10.9px);
            -webkit-backdrop-filter: blur(10.9px);
            margin:auto;
            margin-top:100px;
        }

        .frosted-glass h1{
            color: #ffffff30;
            font-family: "Funnel Display", sans-serif;
            font-weight: 900;
            font-size: 1.25rem;
            margin-bottom: 0;
            rotate: -90deg;
            position: absolute;
            top: 40px;
        }
        
        .frosted-glass .welcome-text h2{
            color: white;
            font-family: "Funnel Display", sans-serif;
            font-weight: 300;
            font-size: 3rem;
            margin-top: 0;
            border-left: 1px solid #fff;
            padding-left: 1rem;
            position: absolute;
            left: 70px;
        }

        .frosted-glass .form-label{
            color: white;
            position: absolute;
            top: 250px;
            left: 229px;
            font-family: "Funnel Display", sans-serif;
            font-size: 1rem;
        }

        .frosted-glass .form-label h2{
            font-weight: 100;
        }

        .white-line{
            position: absolute;
            top: 287px;
            left: 375px;
            width: 199px;
            border-bottom: 1px solid white;
        }

        .frosted-glass form{
            position: relative;
        }

        .input-text-box{
            border-radius: 50px;
            background-color: #ffffff09;
            border: 1px solid rgba(255, 255, 255, 0.384);
            color: white;
            position: absolute;
            top: 325px;
            left: 229px;
            padding: 10px;
            width: 325px;
        }

        .input-text-box::placeholder{
            color:white;
        }

        .frosted-glass form .submit-btn{
            color: white;
            background-color: #d73f09;
            position: absolute;
            top: 325px;
            left: 526px;
            padding: 0.12rem;
            border-radius: 0 50px 50px 0;
            border: 1px solid rgba(255, 255, 255, 0.384);
            width: 50px;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .hide {
            display: none !important;
        }

        .wheel-wrapper {
            position: relative;
            width: 400px;
            height: 400px;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border-radius: 50%;
        }

        .spin-button {
            position: absolute;
            width: 70px;
            height: 70px;
            background: #fff;
            border-radius: 50%;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
            text-transform: uppercase;
            font-weight: 700;
            font-size: 14px;
            color: #333;
            border: 5px solid #333;
            cursor: pointer;
            user-select: none;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .spin-button:hover:not(.spinning) {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .spin-button:active:not(.spinning) {
            transform: scale(0.95);
        }

        .spin-button.spinning {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .spin-button::before {
            content: '';
            position: absolute;
            top: -35px;
            width: 25px;
            height: 35px;
            background: #333;
            clip-path: polygon(50% 0%, 15% 100%, 85% 100%);
        }

        .wheel {
            position: absolute;
            width: 100%;
            height: 100%;
            background: #333;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 0 0 8px #333, 0 0 0 18px #fff, 0 0 0 22px #333;
            transition: transform 5s cubic-bezier(0.17, 0.67, 0.12, 0.99);
        }

        .wheel-segment {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: bottom right;
            transform: rotate(calc(45deg * var(--i)));
            clip-path: polygon(0 0, 60% 0, 100% 100%, 0 60%);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .wheel-segment span {
            position: relative;
            transform: rotate(45deg);
            color: #fff;
            font-size: 2.5em;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        #spinnerWheel {
            opacity: 0;
            transition: opacity 0.8s ease;
            position: absolute;
            top: 205px;
            left: 325px;
        }

        #spinnerWheel.show {
            opacity: 1;
        }

        .fade-out {
            opacity: 0;
            transition: opacity 0.8s ease;
        }

        .flex{
            display:flex;
        }
    </style>
</head>
<body>

<!-- Particle background -->
<canvas id="particleCanvas"></canvas>

<!-- Foreground content -->
<div class="frosted-glass">
    <div class="welcome-text flex">
        <h1>AGU 2025</h1>
        <h2>Oregon State<br>University</h2>
    </div>
<div class="form-label">
    <h2 id="questionLabel">Enter Your Name</h2>
</div>

<div class="white-line"></div>

<form id="questionForm">
    <input type="text" id="questionInput" placeholder="Type here..." class="input-text-box">
    <button type="submit" class="submit-btn">ðŸ¡ª</button>
</form>

</div>
<div id="spinnerWheel" class="hide">
    <div class="wheel-wrapper">
        <div class="spin-button" id="spinBtn">SPIN</div>
        <div class="wheel" id="wheelElement">
            <div class="wheel-segment" style="--i:1; background:#d73f09;"><span>100</span></div>
            <div class="wheel-segment" style="--i:2; background:#4A773C;"><span>50</span></div>
            <div class="wheel-segment" style="--i:3; background:#003B5C;"><span>25</span></div>
            <div class="wheel-segment" style="--i:4; background:#f7a162;"><span>75</span></div>
            <div class="wheel-segment" style="--i:5; background:#d73f09;"><span>100</span></div>
            <div class="wheel-segment" style="--i:6; background:#0D5257;"><span>50</span></div>
            <div class="wheel-segment" style="--i:7; background:#D3832B;"><span>25</span></div>
            <div class="wheel-segment" style="--i:8; background:#4A773C;"><span>6</span></div>
        </div>
    </div>
</div>


<script>
const canvas = document.getElementById("particleCanvas");
const ctx = canvas.getContext("2d");

let particles = [];
const BASE_PARTICLES = 5000;
let collapsing = false;
let collapseCenter = null;

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

function addBaseParticles() {
    particles = [];
    for (let i = 0; i < BASE_PARTICLES; i++) {
        particles.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            vx: (Math.random() - 0.5) * 0.5,
            vy: (Math.random() - 0.5) * 0.5,
            size: Math.random() * 2 + 1,
            color: "rgba(255,255,255,0.5)" // soft white for dark bg
        });
    }
}
addBaseParticles();

function explodeToParticles(x, y) {
    for (let i = 0; i < 30; i++) {
        particles.push({
            x,
            y,
            vx: (Math.random() - 0.5) * 6,
            vy: (Math.random() - 0.5) * 6,
            size: Math.random() * 4 + 2,
            color: "#d73f09"
        });
    }
}

function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

particles.forEach(p => {

    if (!collapsing) {
        // normal movement
        p.x += p.vx;
        p.y += p.vy;

        if (p.x < 0 || p.x > canvas.width) p.vx *= -1;
        if (p.y < 0 || p.y > canvas.height) p.vy *= -1;

    } else {
        // collapse inward
        let dx = collapseCenter.x - p.x;
        let dy = collapseCenter.y - p.y;

        p.x += dx * 0.15;
        p.y += dy * 0.15;

        // shrink particle size
        p.size *= 0.9;

        // remove particles once small
        if (p.size < 0.2) p.size = 0;
    }

    ctx.fillStyle = p.color;
    ctx.beginPath();
    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
    ctx.fill();
});

    requestAnimationFrame(animate);
}
animate();

/* ------------------------------
    QUESTION FLOW LOGIC
------------------------------- */

const questions = [
    { label: "Enter Your Name", placeholder: "Your name" },
    { label: "Your Organization", placeholder: "Organization" },
    { label: "Favorite Color", placeholder: "Favorite color" },
    { label: "Favorite Animal", placeholder: "Favorite animal" }
];

let qIndex = 0;

const questionLabel = document.getElementById("questionLabel");
const questionInput = document.getElementById("questionInput");
const questionForm = document.getElementById("questionForm");

function loadQuestion() {
    const q = questions[qIndex];
    questionLabel.textContent = q.label;
    questionInput.placeholder = q.placeholder;
    questionInput.value = "";
    questionInput.focus();
}

questionForm.addEventListener("submit", (e) => {
    e.preventDefault();

    const value = questionInput.value.trim();
    if (!value) return;

    // Particle burst
    const rect = questionForm.getBoundingClientRect();
    explodeToParticles(rect.left + rect.width / 2, rect.top + rect.height / 2);

    qIndex++;

    if (qIndex < questions.length) {
        loadQuestion();
        return;
    }

    finishedQuestions();
});

function finishedQuestions() {
    const glass = document.querySelector(".frosted-glass");

    // Implode frosted glass
    glass.style.transition = "transform 0.6s ease, opacity 0.6s ease";
    glass.style.transform = "scale(0.2)";
    glass.style.opacity = "0";

    // Fade out particle background
    canvas.classList.add("fade-out");

    // After fade finishes, hide everything + show spinner
    setTimeout(() => {
        // remove frosted glass
        glass.classList.add("hide");

        // hide particle canvas completely
        canvas.style.display = "none";

        // switch to black background
        document.body.style.background = "black";

        // show spinner wheel
        document.getElementById("spinnerWheel").classList.remove("hide");
        
        setTimeout(() => {
            document.getElementById("spinnerWheel").classList.add("show");
        }, 50);

    }, 700);
}

loadQuestion();
/* ------------------------------
    SPINNER LOGIC
------------------------------- */

const wheel = document.getElementById("wheelElement");
const spinBtn = document.getElementById("spinBtn");
let rotation = 0;
let isSpinning = false;
let prizes = [100,50,25,75,100,50,25,6];

spinBtn.addEventListener("click", () => {
    if (isSpinning) return;
    isSpinning = true;

    const spins = 5 + Math.floor(Math.random() * 3);
    const extra = Math.floor(Math.random() * 360);
    const total = (spins * 360) + extra;

    rotation += total;
    wheel.style.transform = `rotate(${rotation}deg)`;

    setTimeout(() => {
        const normalized = rotation % 360;
        const angle = (360 - normalized + 22.5) % 360;
        const segment = Math.floor(angle / 45);
        const prize = prizes[segment];

        alert("You won: " + prize);
        isSpinning = false;
    }, 5000);
});


</script>
</body>
</html>
